CREATE TABLE persona (
    persona_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    telefono VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    is_admin BOOLEAN NOT NULL
);

CREATE TABLE utente (
    utente_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    persona_id BIGINT NOT NULL,
    inizio_iscrizione DATE NOT NULL,
    fine_iscrizione DATE NOT NULL,

    FOREIGN KEY (persona_id) REFERENCES persona (persona_id)
);

CREATE TABLE ruolo(
    ruolo_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome_ruolo VARCHAR(255) NOT NULL
    );

CREATE TABLE personale(
    personale_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    persona_id BIGINT NOT NULL,
    ruolo_id BIGINT NOT NULL,

    FOREIGN KEY (persona_id) REFERENCES persona (persona_id),
    FOREIGN KEY (ruolo_id) REFERENCES ruolo (ruolo_id)
    );

    CREATE TABLE libro(
    libro_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    titolo VARCHAR(255) NOT NULL,
    autore VARCHAR(255) NOT NULL,
    isbn VARCHAR(255) NOT NULL,
    genere VARCHAR(255) NOT NULL,
    editore VARCHAR(255) NOT NULL,
    anno_pubblicazione INTEGER NOT NULL,
    copie INTEGER NOT NULL
    );

    CREATE TABLE prenotazione(
    prenotazione_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    utente_id BIGINT NOT NULL,
    libro_id BIGINT NOT NULL,
    data_prenotazione DATE NOT NULL,
    stato VARCHAR(255) NOT NULL,

    FOREIGN KEY (utente_id) REFERENCES utente (utente_id),
    FOREIGN KEY (libro_id) REFERENCES libro (libro_id));

    CREATE TABLE movimento_libro(
    movimento_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    utente_id BIGINT NOT NULL,
    libro_id BIGINT NOT NULL,
    data_prestito DATE NOT NULL,
    data_scadenza_restituzione DATE NOT NULL,
    data_restituzione DATE,
    stato VARCHAR(255) NOT NULL,

    FOREIGN KEY (utente_id) REFERENCES utente (utente_id),
    FOREIGN KEY (libro_id) REFERENCES libro (libro_id));

    CREATE TABLE indirizzo(
    indirizzo_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nazione VARCHAR(255) NOT NULL,
    citta VARCHAR(255) NOT NULL,
    via VARCHAR(255) NOT NULL,
    tipo_via VARCHAR(255) NOT NULL,
    numero_civico VARCHAR(255) NOT NULL,
    cap VARCHAR(255) NOT NULL,
   tipo_indirizzo VARCHAR(255) NOT NULL
    );

    CREATE TABLE persona_indirizzo(
    persona_indirizzo_id BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    persona_id BIGINT NOT NULL,
    indirizzo_id BIGINT NOT NULL,

    FOREIGN KEY (persona_id) REFERENCES persona (persona_id),
    FOREIGN KEY (indirizzo_id) REFERENCES indirizzo (indirizzo_id));